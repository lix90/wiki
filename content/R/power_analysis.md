---
title: "Power Analysis"
date: 2017-03-22
tag: power, statistics
---

[TOC]

# 统计检验力分析

## 统计检验力

power 统计检验力：如果真实差异存在，统计检验能够检测到真实差异的能力。
$\beta$ 第二类错误概率：当虚无假设（null hypothesis）为假，没有能够拒绝虚无假设的概率。
$$power = 1 - \beta$$
所以统计检验力也就是在虚无假设为假时成功拒绝掉虚无假设的概率。

## 统计检验力的几个问题

- 实验设计有多敏锐？
- 当组间差异真实存在时，实验真实地发现差异有多大可能性？
- 需要多大的样本量才能使得实验具有足够的统计检验力？
- 每组需要包含多少个被试？

## 效应量

对于中等程度的效应量，组间标准差为 1/4 个组内标准差。

## 使用 R 进行统计检验力分析

`power.t.test`
`power.anova.test`

## power 分析的挑战

- 你必须对期望的均值差异进行估计
- 你必须对组内变异进行估计
- 计算更复杂的实验设计的 power 是非常复杂的

**omnibus test** 综合检验只提供给我们进一步分析差异的权限。

# 多重比较

两种多重比较方法

## Planned comparisons

- 事先确定需要比较的组
- 你只能受限于实现确定的比较
- 比较之间必须是正交的（orthogonal）

## post-hoc comparisons

- 根据结果选择比较（追求最显著的差异）
- 可以进行任意多次比较
- 较少的限制
- 需要控制第一类错误率，所以每次比较的结果就将更保守

## 比较次数

两个问题：
- 正交性 orthogonality
- 第一类错误的增加 inflation of Type-I error

问题：可以进行多少次比较，而且不会带来冗余？

## 非冗余比较 Non-redundant contrasts

- 一般来说，对于 n 组数据，在不带来冗余的前提下，最多有 n-1 次比较。
- 数学上，orthogonality 就代表没有冗余。

## 为什么要关注正交性？

- 首要启示：正交比较能够提供关于组间差异的不重复的信息。
- 正规表达：当两个比较为正交的，那么两个样本之间在统计上是独立的。
- 每一个比较都能够提供关于组间差异的唯一的，不重复的信息。
- 每一个比较问的关于数据的不同问题。

## 多重比较检验

* 比较之间是独立的事件
* 概率值不是简单的加总
* Pr(至少犯一次一类错误) = 1 - Pr(没有犯一类错误) = $1 - (1 - \alpha)^C$，C 为比较的次数。
  * 如果 $\alpha = 0.05$, C = 3, 那么 p = 0.143。
  * 如果 C = 10, p = 0.40。

## 几个概念

- error rate per contrast $\alpha\_PC$
  - 特定比较犯一类错误的概率（假阳性概率）
- experiment-wise error rate $\alpha\_EW$
  - 在一次试验中，一次或多次比较犯一类错误的概率
- family-wise error rate $\alpha\_FW$
  - 多个因素试验一次或多次比较犯一类错误的概率

那么，当 C = 3，$\alpha\_PC = 0.05$，那么 $\alpha\_EW = 0.143$。

## 比较方法

### Bonferroni

- 简单
- $\alpha\_PC = \frac{\alpha}{C}$，C 为比较的总次数。
- 适合比较次数少时

### Holm-Bonferroni

- 相比 bonferroni 没有那么保守
- p 值越小矫正越大

### Keppel 等人的观点

- 如果比较为 n-1 次正交的事前比较，不需要矫正显著性水平
- 如果为事前比较，正交的，且次数小于等于 n-1，那么比较并不是数据驱动，那么不需要矫正显著性水平

## 事后成对比较

Tukey 方法（`TukeyHSD()`）允许进行一个实验中所有可能的成对比较，然后保持 $\alpha\_EW = 0.05$。如果样本方差不相同，或者样本量不同，需要使用修改的 Tukey 方法。

Scheffe 方法也比较保守。

其它方法：
- Dunnett
- Fisher's LSD
- Newman-Keuls

## 如何应对多重比较问题？

- 决定那种方法最合理，提供数据和实验设计
- 做好为自己的方法进行辩护的准备
- 如果有必要，可能会换一种方法
- 实验室、领域、期刊更推崇那种方法？
